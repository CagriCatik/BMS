<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>Initial SOC Estimation - Battery Management Systems</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/custom.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Battery Management Systems</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="initial-soc-estimation"><a class="header" href="#initial-soc-estimation">Initial SoC Estimation</a></h1>
<h2 id="introduction"><a class="header" href="#introduction"><strong>Introduction</strong></a></h2>
<p>Battery Management Systems (BMS) play a crucial role in the operation and management of batteries in modern applications, particularly in electric vehicles (EVs), renewable energy systems, and portable electronics. This documentation provides an in-depth explanation of critical BMS concepts, focusing on <strong>State of Charge (SoC) Estimation</strong>, <strong>Coulomb Counting</strong>, and foundational algorithms. It is structured to provide both foundational knowledge and technical depth for engineers and professionals in the field.</p>
<hr />
<h2 id="state-of-charge-soc-estimation"><a class="header" href="#state-of-charge-soc-estimation"><strong>State of Charge (SoC) Estimation</strong></a></h2>
<h3 id="1-overview"><a class="header" href="#1-overview"><strong>1. Overview</strong></a></h3>
<p>State of Charge (SoC) represents the available capacity of a battery as a percentage of its total capacity. Accurate SoC estimation is critical for ensuring optimal battery performance, preventing overcharging or deep discharging, and prolonging battery life.</p>
<hr />
<h3 id="2-initial-soc-estimation"><a class="header" href="#2-initial-soc-estimation"><strong>2. Initial SoC Estimation</strong></a></h3>
<p>Initial SoC estimation involves determining the battery's SoC after a prolonged period of inactivity or at the start of operation. This process is divided into two main stages:</p>
<h4 id="21-static-soc-estimation"><a class="header" href="#21-static-soc-estimation"><strong>2.1 Static SoC Estimation</strong></a></h4>
<ul>
<li><strong>Definition</strong>: Static SoC estimation determines the battery's charge state when it is at rest (no current flow).</li>
<li><strong>Key Conditions</strong>:
<ul>
<li><strong>Zero Current Flow</strong>: The current drawn from or pumped into the battery must be zero.</li>
<li><strong>Time Constraint</strong>: The battery must remain in a static state for a minimum duration (e.g., 10 seconds).</li>
</ul>
</li>
<li><strong>Example Scenario</strong>: A vehicle at a red traffic signal or parked can be considered in a static state, provided no significant current flows.</li>
</ul>
<h4 id="22-procedure-for-initial-soc-estimation"><a class="header" href="#22-procedure-for-initial-soc-estimation"><strong>2.2 Procedure for Initial SoC Estimation</strong></a></h4>
<ol>
<li><strong>Voltage Measurement</strong>: Measure the terminal voltage of the battery under static conditions.</li>
<li><strong>Open Circuit Voltage (OCV)</strong>:
<ul>
<li>When the current is zero, the terminal voltage equals the Open Circuit Voltage (OCV).</li>
<li>The OCV is a key parameter for determining SoC.</li>
</ul>
</li>
<li><strong>OCV-SoC Lookup Table</strong>:
<ul>
<li>Use an OCV-SoC chart specific to the battery chemistry (e.g., lithium-ion).</li>
<li>Convert the measured OCV to the corresponding SoC value using a pre-defined lookup table.</li>
</ul>
</li>
</ol>
<div class="table-wrapper"><table><thead><tr><th><strong>Voltage (V)</strong></th><th><strong>SoC (%)</strong></th></tr></thead><tbody>
<tr><td>4.2</td><td>100</td></tr>
<tr><td>3.6</td><td>50</td></tr>
<tr><td>3.0</td><td>0</td></tr>
</tbody></table>
</div>
<hr />
<h3 id="3-coulomb-counting-method"><a class="header" href="#3-coulomb-counting-method"><strong>3. Coulomb Counting Method</strong></a></h3>
<p>Coulomb Counting is a dynamic SoC estimation technique used during battery operation.</p>
<h4 id="31-definition"><a class="header" href="#31-definition"><strong>3.1 Definition</strong></a></h4>
<p>Coulomb Counting calculates SoC based on the net current flow over time, integrating charge inflows and outflows.</p>
<h4 id="32-equation"><a class="header" href="#32-equation"><strong>3.2 Equation</strong></a></h4>
<p>[
\text{SoC}_{t+1} = \text{SoC}_t - \frac{I \cdot \Delta t}{C}
]</p>
<ul>
<li><strong>Terms</strong>:
<ul>
<li>(\text{SoC}_{t+1}): SoC at the next time step.</li>
<li>(\text{SoC}_t): SoC at the current time step.</li>
<li>(I): Current flow (positive for charging, negative for discharging).</li>
<li>(\Delta t): Time interval between measurements.</li>
<li>(C): Battery capacity in ampere-hours (Ah).</li>
</ul>
</li>
</ul>
<h4 id="33-key-considerations"><a class="header" href="#33-key-considerations"><strong>3.3 Key Considerations</strong></a></h4>
<ul>
<li><strong>Sampling Rate</strong>: The frequency at which current data is sampled affects the accuracy of SoC estimation.
<ul>
<li>For example, sampling every 100 milliseconds requires multiplying the current by 0.1 seconds.</li>
</ul>
</li>
<li><strong>Battery Aging</strong>: Battery capacity decreases over time, requiring periodic recalibration of SoC algorithms.</li>
</ul>
<h4 id="34-advantages-and-limitations"><a class="header" href="#34-advantages-and-limitations"><strong>3.4 Advantages and Limitations</strong></a></h4>
<div class="table-wrapper"><table><thead><tr><th><strong>Advantages</strong></th><th><strong>Limitations</strong></th></tr></thead><tbody>
<tr><td>High accuracy during operation</td><td>Errors accumulate over time</td></tr>
<tr><td>Suitable for real-time applications</td><td>Requires precise current measurement</td></tr>
<tr><td>Complements static SoC estimation</td><td>Sensitive to noise and drift in sensors</td></tr>
</tbody></table>
</div>
<hr />
<h2 id="state-of-health-soh-estimation"><a class="header" href="#state-of-health-soh-estimation"><strong>State of Health (SoH) Estimation</strong></a></h2>
<h3 id="1-overview-1"><a class="header" href="#1-overview-1"><strong>1. Overview</strong></a></h3>
<p>State of Health (SoH) quantifies the overall health of the battery, representing its remaining capacity as a percentage of the original capacity.</p>
<h3 id="2-factors-affecting-soh"><a class="header" href="#2-factors-affecting-soh"><strong>2. Factors Affecting SoH</strong></a></h3>
<ul>
<li><strong>Capacity Fade</strong>: Reduction in total capacity due to repeated charge/discharge cycles.</li>
<li><strong>Internal Resistance</strong>: Increase in resistance leading to reduced efficiency.</li>
<li><strong>Temperature Effects</strong>: Degradation caused by operating at extreme temperatures.</li>
</ul>
<hr />
<h2 id="implementation-in-matlab"><a class="header" href="#implementation-in-matlab"><strong>Implementation in MATLAB</strong></a></h2>
<h3 id="1-algorithm-design"><a class="header" href="#1-algorithm-design"><strong>1. Algorithm Design</strong></a></h3>
<p>The initial and dynamic SoC estimation algorithms can be implemented in MATLAB to simulate and validate the BMS operation.</p>
<h4 id="11-steps-for-implementation"><a class="header" href="#11-steps-for-implementation"><strong>1.1 Steps for Implementation</strong></a></h4>
<ol>
<li>Define the battery parameters (capacity, chemistry, aging factors).</li>
<li>Create an OCV-SoC lookup table based on battery specifications.</li>
<li>Implement the static SoC estimation algorithm:
<ul>
<li>Monitor current and voltage.</li>
<li>Apply conditions for static state detection.</li>
</ul>
</li>
<li>Implement the Coulomb Counting algorithm:
<ul>
<li>Integrate current over time intervals.</li>
<li>Include compensation for sensor noise and drift.</li>
</ul>
</li>
<li>Test and validate the algorithms with various current profiles (e.g., square pulse, triangular waveform).</li>
</ol>
<hr />
<h3 id="2-simulation-scenarios"><a class="header" href="#2-simulation-scenarios"><strong>2. Simulation Scenarios</strong></a></h3>
<ul>
<li><strong>Continuous Current</strong>: Simulate steady-state operation.</li>
<li><strong>Dynamic Current</strong>: Test performance under variable load conditions.</li>
<li><strong>Aging Effects</strong>: Evaluate SoC estimation with degraded battery capacity.</li>
</ul>
<h4 id="example-matlab-pseudo-code"><a class="header" href="#example-matlab-pseudo-code"><strong>Example MATLAB Pseudo-Code</strong></a></h4>
<pre><code class="language-matlab">% Define battery parameters
capacity = 100; % in Ah
initial_SoC = 100; % in %

% OCV-SoC Lookup Table
OCV = [4.2, 4.0, 3.8, 3.6, 3.4, 3.2];
SoC = [100, 90, 75, 50, 25, 0];

% Static SoC Estimation
if (current == 0 &amp;&amp; time_static &gt; 10)
    measured_voltage = terminal_voltage;
    estimated_SoC = interp1(OCV, SoC, measured_voltage);
end

% Coulomb Counting
delta_t = 0.1; % Sampling interval in seconds
for t = 1:length(current_data)
    SoC(t+1) = SoC(t) - (current_data(t) * delta_t) / capacity;
end
</code></pre>
<hr />
<h2 id="future-enhancements"><a class="header" href="#future-enhancements"><strong>Future Enhancements</strong></a></h2>
<ul>
<li><strong>Advanced Estimation Techniques</strong>:
<ul>
<li>Kalman Filtering for error correction.</li>
<li>Machine Learning models for complex patterns.</li>
</ul>
</li>
<li><strong>State of Power (SoP)</strong>: Estimate the instantaneous power capability of the battery.</li>
<li><strong>Integration with Embedded Systems</strong>:
<ul>
<li>Real-time BMS on microcontrollers or FPGAs.</li>
<li>Enhanced fault detection mechanisms.</li>
</ul>
</li>
</ul>
<hr />
<h2 id="conclusion"><a class="header" href="#conclusion"><strong>Conclusion</strong></a></h2>
<p>Battery and Battery Management Systems are critical for the safe and efficient operation of energy storage solutions. Accurate SoC estimation, both static and dynamic, ensures reliable performance and longevity. By implementing these concepts in MATLAB, engineers can simulate, validate, and optimize BMS algorithms for real-world applications.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../system_and_algorithms/bms_algorithms.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../system_and_algorithms/cycle_counting_soh.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../system_and_algorithms/bms_algorithms.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../system_and_algorithms/cycle_counting_soh.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
