<!DOCTYPE HTML>
<html lang="en" class="rust sidebar-visible" dir="ltr">
    <head>
        <!-- Book generated using mdBook -->
        <meta charset="UTF-8">
        <title>BMS State Machine - Battery Management Systems</title>


        <!-- Custom HTML head -->

        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="theme-color" content="#ffffff">

        <link rel="icon" href="../favicon.svg">
        <link rel="shortcut icon" href="../favicon.png">
        <link rel="stylesheet" href="../css/variables.css">
        <link rel="stylesheet" href="../css/general.css">
        <link rel="stylesheet" href="../css/chrome.css">
        <link rel="stylesheet" href="../css/print.css" media="print">

        <!-- Fonts -->
        <link rel="stylesheet" href="../FontAwesome/css/font-awesome.css">
        <link rel="stylesheet" href="../fonts/fonts.css">

        <!-- Highlight.js Stylesheets -->
        <link rel="stylesheet" href="../highlight.css">
        <link rel="stylesheet" href="../tomorrow-night.css">
        <link rel="stylesheet" href="../ayu-highlight.css">

        <!-- Custom theme stylesheets -->
        <link rel="stylesheet" href="../src/custom.css">


        <!-- Provide site root to javascript -->
        <script>
            var path_to_root = "../";
            var default_theme = window.matchMedia("(prefers-color-scheme: dark)").matches ? "navy" : "rust";
        </script>
        <!-- Start loading toc.js asap -->
        <script src="../toc.js"></script>
    </head>
    <body>
    <div id="body-container">
        <!-- Work around some values being stored in localStorage wrapped in quotes -->
        <script>
            try {
                var theme = localStorage.getItem('mdbook-theme');
                var sidebar = localStorage.getItem('mdbook-sidebar');

                if (theme.startsWith('"') && theme.endsWith('"')) {
                    localStorage.setItem('mdbook-theme', theme.slice(1, theme.length - 1));
                }

                if (sidebar.startsWith('"') && sidebar.endsWith('"')) {
                    localStorage.setItem('mdbook-sidebar', sidebar.slice(1, sidebar.length - 1));
                }
            } catch (e) { }
        </script>

        <!-- Set the theme before any content is loaded, prevents flash -->
        <script>
            var theme;
            try { theme = localStorage.getItem('mdbook-theme'); } catch(e) { }
            if (theme === null || theme === undefined) { theme = default_theme; }
            const html = document.documentElement;
            html.classList.remove('rust')
            html.classList.add(theme);
            html.classList.add("js");
        </script>

        <input type="checkbox" id="sidebar-toggle-anchor" class="hidden">

        <!-- Hide / unhide sidebar before it is displayed -->
        <script>
            var sidebar = null;
            var sidebar_toggle = document.getElementById("sidebar-toggle-anchor");
            if (document.body.clientWidth >= 1080) {
                try { sidebar = localStorage.getItem('mdbook-sidebar'); } catch(e) { }
                sidebar = sidebar || 'visible';
            } else {
                sidebar = 'hidden';
            }
            sidebar_toggle.checked = sidebar === 'visible';
            html.classList.remove('sidebar-visible');
            html.classList.add("sidebar-" + sidebar);
        </script>

        <nav id="sidebar" class="sidebar" aria-label="Table of contents">
            <!-- populated by js -->
            <mdbook-sidebar-scrollbox class="sidebar-scrollbox"></mdbook-sidebar-scrollbox>
            <noscript>
                <iframe class="sidebar-iframe-outer" src="../toc.html"></iframe>
            </noscript>
            <div id="sidebar-resize-handle" class="sidebar-resize-handle">
                <div class="sidebar-resize-indicator"></div>
            </div>
        </nav>

        <div id="page-wrapper" class="page-wrapper">

            <div class="page">
                <div id="menu-bar-hover-placeholder"></div>
                <div id="menu-bar" class="menu-bar sticky">
                    <div class="left-buttons">
                        <label id="sidebar-toggle" class="icon-button" for="sidebar-toggle-anchor" title="Toggle Table of Contents" aria-label="Toggle Table of Contents" aria-controls="sidebar">
                            <i class="fa fa-bars"></i>
                        </label>
                        <button id="theme-toggle" class="icon-button" type="button" title="Change theme" aria-label="Change theme" aria-haspopup="true" aria-expanded="false" aria-controls="theme-list">
                            <i class="fa fa-paint-brush"></i>
                        </button>
                        <ul id="theme-list" class="theme-popup" aria-label="Themes" role="menu">
                            <li role="none"><button role="menuitem" class="theme" id="light">Light</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="rust">Rust</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="coal">Coal</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="navy">Navy</button></li>
                            <li role="none"><button role="menuitem" class="theme" id="ayu">Ayu</button></li>
                        </ul>
                        <button id="search-toggle" class="icon-button" type="button" title="Search. (Shortkey: s)" aria-label="Toggle Searchbar" aria-expanded="false" aria-keyshortcuts="S" aria-controls="searchbar">
                            <i class="fa fa-search"></i>
                        </button>
                    </div>

                    <h1 class="menu-title">Battery Management Systems</h1>

                    <div class="right-buttons">
                        <a href="../print.html" title="Print this book" aria-label="Print this book">
                            <i id="print-button" class="fa fa-print"></i>
                        </a>

                    </div>
                </div>

                <div id="search-wrapper" class="hidden">
                    <form id="searchbar-outer" class="searchbar-outer">
                        <input type="search" id="searchbar" name="searchbar" placeholder="Search this book ..." aria-controls="searchresults-outer" aria-describedby="searchresults-header">
                    </form>
                    <div id="searchresults-outer" class="searchresults-outer hidden">
                        <div id="searchresults-header" class="searchresults-header"></div>
                        <ul id="searchresults">
                        </ul>
                    </div>
                </div>

                <!-- Apply ARIA attributes after the sidebar and the sidebar toggle button are added to the DOM -->
                <script>
                    document.getElementById('sidebar-toggle').setAttribute('aria-expanded', sidebar === 'visible');
                    document.getElementById('sidebar').setAttribute('aria-hidden', sidebar !== 'visible');
                    Array.from(document.querySelectorAll('#sidebar a')).forEach(function(link) {
                        link.setAttribute('tabIndex', sidebar === 'visible' ? 0 : -1);
                    });
                </script>

                <div id="content" class="content">
                    <main>
                        <h1 id="bms-state-machine"><a class="header" href="#bms-state-machine">BMS State Machine</a></h1>
<p>This state diagram outlines the various operating states of the Battery Management System (BMS) and the transitions between these states based on specific events and conditions.</p>
<h2 id="overview-of-the-state-diagram"><a class="header" href="#overview-of-the-state-diagram"><strong>Overview of the State Diagram</strong></a></h2>
<p>The state diagram comprises six primary states: Sleep Mode, Active Mode, Start Mode, Operational Mode, Fault Mode, and Safety Mode. The state machine initiates in Sleep Mode and transitions between the different states in response to various events and conditions.</p>
<pre><code class="language-mermaid">stateDiagram-v2
    [*] --&gt; Sleep_Mode

    Sleep_Mode: Minimizes energy consumption \ Periodic wake-up based on cycle time
    Sleep_Mode --&gt; Start_Mode : Vehicle turned on
    Sleep_Mode --&gt; Active_Mode : Temporary activation

    Active_Mode: Conducts system checks \ Error detection and logging \ Controls cooling and heating functions
    Active_Mode --&gt; Sleep_Mode : Completion of inspections

    Start_Mode: Verifies battery condition \ Activates relays for motor power
    Start_Mode --&gt; Operational_Mode : Successful verification
    Start_Mode --&gt; Fault_Mode : Fault detected

    Operational_Mode: Continuously monitors battery \ Dynamically adjusts cooling/heating measures
    Operational_Mode --&gt; Sleep_Mode : Vehicle turned off
    Operational_Mode --&gt; Fault_Mode : Fault detected

    Fault_Mode: Analyzes and categorizes fault \ Stores and displays fault
    Fault_Mode --&gt; Safety_Mode : Critical fault
    Fault_Mode --&gt; Operational_Mode : Fault resolved

    Safety_Mode: Interrupts driving power \ Completely shuts down battery
    Safety_Mode --&gt; Operational_Mode : Fault resolved and verified
    Safety_Mode --&gt; Sleep_Mode : After complete shutdown
</code></pre>
<p>The sequence diagram begins in Sleep Mode and transitions between various states based on events and conditions.</p>
<pre><code class="language-mermaid">sequenceDiagram
    participant Vehicle
    participant System

    Vehicle-&gt;&gt;System: Turn on vehicle
    System-&gt;&gt;System: Transition to Start_Mode
    activate System
    System-&gt;&gt;System: Verify battery condition
    alt Successful verification
        System-&gt;&gt;System: Transition to Operational_Mode
        System-&gt;&gt;System: Monitor battery
        System-&gt;&gt;System: Dynamically adjust cooling/heating measures
        Vehicle-&gt;&gt;System: Turn off vehicle
        System-&gt;&gt;System: Transition to Sleep_Mode
    else Fault detected
        System-&gt;&gt;System: Transition to Fault_Mode
        System-&gt;&gt;System: Analyze and log fault
        alt Critical fault
            System-&gt;&gt;System: Transition to Safety_Mode
            System-&gt;&gt;System: Interrupt driving power
            Vehicle-&gt;&gt;System: Fault resolved
            System-&gt;&gt;System: Transition to Operational_Mode
        else Fault resolved
            System-&gt;&gt;System: Transition to Operational_Mode
        end
    end
    deactivate System
</code></pre>
<h2 id="detailed-description-of-states-and-transitions"><a class="header" href="#detailed-description-of-states-and-transitions"><strong>Detailed Description of States and Transitions</strong></a></h2>
<h3 id="1-sleep-mode"><a class="header" href="#1-sleep-mode">1. <strong>Sleep Mode</strong></a></h3>
<p><strong>Description:</strong>
In Sleep Mode, the BMS minimizes energy consumption to extend the battery's lifespan. The system periodically wakes up according to a programmed cycle time to perform specific tasks or check the system status.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Sleep Mode to Start Mode:</strong> Triggered when the vehicle is turned on. This transition prepares the BMS for operation.</li>
<li><strong>Sleep Mode to Active Mode:</strong> Occurs during temporary activations, such as when immediate inspections or controls are required.</li>
</ul>
<h3 id="2-active-mode"><a class="header" href="#2-active-mode">2. <strong>Active Mode</strong></a></h3>
<p><strong>Description:</strong>
Active Mode is a transient state where the BMS conducts comprehensive system checks to ensure all components are functioning correctly. During this state, the BMS detects and logs any errors and actively controls the cooling and heating systems to regulate the battery's temperature.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Active Mode to Sleep Mode:</strong> After completing the necessary inspections and control tasks, the BMS returns to Sleep Mode to conserve energy.</li>
</ul>
<h3 id="3-start-mode"><a class="header" href="#3-start-mode">3. <strong>Start Mode</strong></a></h3>
<p><strong>Description:</strong>
Start Mode is initiated when the vehicle begins to start. In this state, the BMS verifies the condition of the vehicle's battery and activates the necessary relays to supply power to the motor.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Start Mode to Operational Mode:</strong> Occurs upon successful verification of the battery condition, allowing the BMS to take over continuous monitoring and control.</li>
<li><strong>Start Mode to Fault Mode:</strong> If a fault is detected during verification, the BMS transitions to Fault Mode for further analysis and handling.</li>
</ul>
<h3 id="4-operational-mode"><a class="header" href="#4-operational-mode">4. <strong>Operational Mode</strong></a></h3>
<p><strong>Description:</strong>
Operational Mode represents the primary operating state during vehicle use. The BMS continuously monitors battery parameters and dynamically adjusts cooling and heating measures to optimize battery performance and longevity.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Operational Mode to Sleep Mode:</strong> Triggered when the vehicle is turned off, prompting the BMS to minimize energy consumption.</li>
<li><strong>Operational Mode to Fault Mode:</strong> Activated upon detection of a fault during continuous monitoring, necessitating a transition to Fault Mode.</li>
</ul>
<h3 id="5-fault-mode"><a class="header" href="#5-fault-mode">5. <strong>Fault Mode</strong></a></h3>
<p><strong>Description:</strong>
Fault Mode is activated when the BMS detects an error within the battery system. In this state, the BMS analyzes and categorizes the fault, stores the information for future maintenance, and displays an error indicator to the driver.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Fault Mode to Safety Mode:</strong> Initiated when a critical fault is identified that compromises the vehicle's safe operation.</li>
<li><strong>Fault Mode to Operational Mode:</strong> Occurs when the detected fault is resolved, allowing the BMS to resume normal monitoring and control.</li>
</ul>
<h3 id="6-safety-mode"><a class="header" href="#6-safety-mode">6. <strong>Safety Mode</strong></a></h3>
<p><strong>Description:</strong>
Safety Mode is the ultimate protective state activated in response to critical faults. In this state, the BMS interrupts the driving power and completely shuts down the battery to ensure the safety of the vehicle and its occupants.</p>
<p><strong>Transitions:</strong></p>
<ul>
<li><strong>Safety Mode to Operational Mode:</strong> After the critical fault is resolved and verified, the BMS transitions back to Operational Mode.</li>
<li><strong>Safety Mode to Sleep Mode:</strong> Occurs following the complete shutdown of the battery when no further actions are required.</li>
</ul>
<h2 id="overall-system-behavior"><a class="header" href="#overall-system-behavior"><strong>Overall System Behavior</strong></a></h2>
<p>The state diagram describes a robust and flexible Battery Management System capable of efficiently transitioning between various operating states to minimize energy consumption while ensuring the vehicle's safety and reliability.</p>
<h3 id="normal-operational-flows"><a class="header" href="#normal-operational-flows"><strong>Normal Operational Flows:</strong></a></h3>
<ol>
<li>
<p><strong>Vehicle Start:</strong>
Upon turning on the vehicle, the control unit initiates a transition from Sleep Mode to Start Mode. In Start Mode, the BMS verifies the battery condition and activates the necessary relays to supply power to the motor. If the verification is successful, the BMS transitions to Operational Mode.</p>
</li>
<li>
<p><strong>Continuous Monitoring:</strong>
In Operational Mode, the BMS continuously monitors battery parameters and dynamically adjusts cooling and heating measures to maintain optimal conditions. If necessary, the BMS can temporarily switch to Active Mode to perform additional inspections or specific controls.</p>
</li>
<li>
<p><strong>Vehicle Shutdown:</strong>
When the vehicle is turned off, the BMS transitions from Operational Mode back to Sleep Mode to conserve energy.</p>
</li>
</ol>
<h3 id="error-handling"><a class="header" href="#error-handling"><strong>Error Handling:</strong></a></h3>
<ol>
<li>
<p><strong>Error Detection:</strong>
During operation, the BMS may detect errors that prompt a transition to Fault Mode.</p>
</li>
<li>
<p><strong>Error Analysis:</strong>
In Fault Mode, the BMS analyzes and categorizes the error. If the error is critical, the system transitions to Safety Mode to protect the battery and prevent potential hazards by interrupting the driving power and shutting down the battery.</p>
</li>
<li>
<p><strong>Error Resolution:</strong>
Once the error is resolved, the BMS can transition back to Operational Mode to resume normal monitoring and control. If no further actions are needed, the system may also revert to Sleep Mode.</p>
</li>
</ol>
<h3 id="safety-mechanisms"><a class="header" href="#safety-mechanisms"><strong>Safety Mechanisms:</strong></a></h3>
<p>Transitioning to Safety Mode in the event of critical faults ensures that the vehicle remains in a safe state by interrupting the driving power and completely shutting down the battery. This prevents potential damage or dangerous situations that could arise from malfunctioning battery operations.</p>
<h2 id="summary"><a class="header" href="#summary"><strong>Summary</strong></a></h2>
<p>The state machine for the Battery Management System (BMS) is designed to efficiently transition between various operating states to minimize energy consumption, extend battery lifespan, and ensure vehicle safety. By clearly structuring the states and transitions, the BMS can effectively respond to both normal operational conditions and faults, thereby supporting the reliable and secure operation of the vehicle.</p>

                    </main>

                    <nav class="nav-wrapper" aria-label="Page navigation">
                        <!-- Mobile navigation buttons -->
                            <a rel="prev" href="../system_and_algorithms/bms_architecture.html" class="mobile-nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                                <i class="fa fa-angle-left"></i>
                            </a>

                            <a rel="next prefetch" href="../system_and_algorithms/control_systems.html" class="mobile-nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                                <i class="fa fa-angle-right"></i>
                            </a>

                        <div style="clear: both"></div>
                    </nav>
                </div>
            </div>

            <nav class="nav-wide-wrapper" aria-label="Page navigation">
                    <a rel="prev" href="../system_and_algorithms/bms_architecture.html" class="nav-chapters previous" title="Previous chapter" aria-label="Previous chapter" aria-keyshortcuts="Left">
                        <i class="fa fa-angle-left"></i>
                    </a>

                    <a rel="next prefetch" href="../system_and_algorithms/control_systems.html" class="nav-chapters next" title="Next chapter" aria-label="Next chapter" aria-keyshortcuts="Right">
                        <i class="fa fa-angle-right"></i>
                    </a>
            </nav>

        </div>




        <script>
            window.playground_copyable = true;
        </script>


        <script src="../elasticlunr.min.js"></script>
        <script src="../mark.min.js"></script>
        <script src="../searcher.js"></script>

        <script src="../clipboard.min.js"></script>
        <script src="../highlight.js"></script>
        <script src="../book.js"></script>

        <!-- Custom JS scripts -->


    </div>
    </body>
</html>
